<div class="page-container"><!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->

  <%= render 'layouts/sidebar' %>



  <div class="main-content">
    <%= render 'layouts/dealer_admin_nav' %>

    <h2>Edit Deal </h2>

    <%= form_for [@dealership, @deal], :html => {:class => "form-horizontal form-groups-bordered"} do |f| %>
    <%= render 'layouts/error_messages', object: f.object %>
    <div class="form-group">
      <label class="col-sm-3 control-label">Vehicle</label>
      <div class="col-sm-5">
        <% car = Car.find(@deal.car_id) %>
        <%= car.make_model_year %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Customer</label>
      <div class="col-sm-5">
        <%= f.collection_select :customer_id, @customers.all, :id, :name, prompt: true, class: "form-control" %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Employee</label>
      <div class="col-sm-5">
        <%= f.collection_select :employee_id, @employees.all, :id, :name, prompt: true, class: "form-control" %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Date</label>
      <div class="col-sm-5">
        <%= f.date_field :date, class: "form-control" %>
      </div>
    </div>

    <br/>
    <h3>Financials</h3>
    <div class="form-group">
      <label class="col-sm-3 control-label">Sales Price</label>
      <div class="col-sm-5">
        <div class="input-group">
          <span class="input-group-addon">$</span>
          <%= f.text_field :amount, class: "form-control" %>
        </div>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Sales Tax Percent</label>
      <div class="col-sm-5">
          <div class="input-group">
              <%= f.text_field :sales_tax_percent, value: @dealership.sales_tax, class: "form-control" %>
            <span class="input-group-addon">%</span>
          </div>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Down Payment</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :down_payment, value: @fields["down_payment"], class: "form-control" %>
          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :down_payment, class: "form-control" %>
          </div>
        <% end %>
      </div>
    </div>
   <div class="form-group">
     <label class="col-sm-3 control-label">Defered Down Payment</label>
     <div class="col-sm-5">
       <% if @fields %>
         <div class="input-group">
           <span class="input-group-addon">$</span>
           <%= f.text_field :deffered_down_1_payment, value: @fields["deffered_down_1_payment"], class: "form-control" %>
         </div>
       <% else %>
         <div class="input-group">
           <span class="input-group-addon">$</span>
           <%= f.text_field :deffered_down_1_payment, class: "form-control" %>
         </div>
       <% end %>
     </div>
   </div>
   <div class="form-group">
     <label class="col-sm-3 control-label">Defered Down Payment Date</label>
     <div class="col-sm-5">
       <% if @fields %>
         <div class="input-group">
           <%= f.date_field :deffered_down_1_date, value: @fields["deffered_down_1_date"], class: "form-control" %>
         </div>
       <% else %>
         <div class="input-group">
           <%= f.date_field :deffered_down_1_date, class: "form-control" %>
         </div>
       <% end %>
     </div>
   </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Term</label>
      <div class="col-sm-5">
        <% if @fields %>
        <div class="input-group">
        <%= f.text_field :term, value: @fields["term"], class: "form-control" %>
        <span class="input-group-addon">months</span>
        </div>
        <% else %>
        <div class="input-group">
        <%= f.text_field :term, class: "form-control" %>
        <span class="input-group-addon">months</span>
        </div>
        <% end %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">APR</label>
      <div class="col-sm-5">
        <% if @fields %>
        <div class="input-group">
        <%= f.text_field :apr, value: @fields["apr"], class: "form-control" %>
        <span class="input-group-addon">%</span>
        </div>
        <% else %>
        <div class="input-group">
        <%= f.text_field :apr, class: "form-control" %>
        <span class="input-group-addon">%</span>
        </div>
        <% end %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Trade In Value</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :trade_in_value, value: @fields["trade_in_value"], class: "form-control" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :trade_in_value, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Less Payoff</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :less_payoff, value: @fields["less_payoff"], class: "form-control" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :less_payoff, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Smog Fee</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :smog_fee, value: @fields["smog_fee"], class: "form-control" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :smog_fee, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Document Fee</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :doc_fee, value: @fields["doc_fee"], class: "form-control" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :doc_fee, value: 50, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Registration Fee</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :reg_fee, value: @fields["reg_fee"], class: "form-control" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :reg_fee, value: 50, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>

    <div class="form-group">
      <label class="col-sm-3 control-label">Other Fees</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :other_fee, value: @fields["other_fee"], class: "form-control" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :other_fee, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>

    <br/>
    <h3>GAP Insurance</h3>
    <div class="form-group">
      <label class="col-sm-3 control-label">Gap Insurance Provider</label>
      <div class="col-sm-5">
        <%= f.collection_select :gap_id, @gaps, :id, :name, prompt: true, class: "form-control", :include_blank => "No Provider" %>   &nbsp; <%= link_to "(Add New Provider)", new_dealership_gap_path(@dealership), target: "_blank" %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Term</label>
      <div class="col-sm-5">
        <% if @fields %>
        <div class="input-group">
        <%= f.text_field :gap_term, value: @fields["gap_term"], class: "form-control" %>
        <span class="input-group-addon">months</span>
        </div>
        <% else %>
        <div class="input-group">
        <%= f.text_field :gap_term, class: "form-control" %>
        <span class="input-group-addon">months</span>
        </div>
        <% end %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">GAP Price</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :gap_price, value: @fields["gap_price"], class: "form-control", :include_blank => "No Provider" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :gap_price, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>

    <h3>Warranty</h3>
    <div class="form-group">
      <label class="col-sm-3 control-label">Warranty Provider</label>
      <div class="col-sm-5">
        <%= f.collection_select :warranty_id, @warranties, :id, :name, prompt: true, class: "form-control", :include_blank => "No Provider" %>   &nbsp; <%= link_to "(Add New Provider)", new_dealership_warranty_path(@dealership), target: "_blank" %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Type</label>
      <div class="col-sm-5">
          <div class="input-group">
              <%= f.text_field :warranty_type, class: "form-control" %>
          </div>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Term</label>
      <div class="col-sm-5">
        <% if @fields %>
        <div class="input-group">
        <%= f.text_field :warranty_term, value: @fields["warranty_term"], class: "form-control" %>
        <span class="input-group-addon">months</span>
        </div>
        <% else %>
        <div class="input-group">
        <%= f.text_field :warranty_term, class: "form-control" %>
        <span class="input-group-addon">months</span>
        </div>
        <% end %>
      </div>
    </div>

    <div class="form-group">
      <label class="col-sm-3 control-label">Warranty Price</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :warranty_price, value: @fields["warranty_price"], class: "form-control" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :warranty_price, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>

    <h3>Lenders</h3>
    <div class="form-group">
      <label class="col-sm-3 control-label">Lender</label>
      <div class="col-sm-5">
        <%= f.collection_select :lender_id, @lenders, :id, :name, prompt: true, class: "form-control", :include_blank => "No Lender" %>   &nbsp; <%= link_to "(Add New Lender)", new_dealership_lender_path(@dealership), target: "_blank" %>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-3 control-label">Discount Fee</label>
      <div class="col-sm-5">
        <% if @fields %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :discount_fee, value: @fields["discount_fee"], class: "form-control" %>

          </div>
        <% else %>
          <div class="input-group">
            <span class="input-group-addon">$</span>
            <%= f.text_field :discount_fee, class: "form-control" %>

          </div>
        <% end %>
      </div>
    </div>


    <div class="form-group">
      <label class="col-sm-3 control-label"></label>
      <div class="col-sm-5">
        <%= f.submit "Update Deal", :class => 'btn btn-success'  %>

      </div>
    </div>
    <% end %>




  </div>
</div>




